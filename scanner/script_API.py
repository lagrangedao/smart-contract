import requests

# res = requests.get('https://api.polygonscan.com/api?module=account&action=txlist&address=0xA1f32c758c4324cC3070A3AA107C4dC7DdFe1a6f&startblock=38542683&endblock=latest&sort=asc&apikey=Z4PKKUT2I43FNR8JQMCQS8QXV6D2G6ZBQB')

# Config: 
startblock = "32818038"
endblock = "latest"
# SwanPayment contract address:
contractAddress = "0xA1f32c758c4324cC3070A3AA107C4dC7DdFe1a6f"
apikey = "Z4PKKUT2I43FNR8JQMCQS8QXV6D2G6ZBQB"

# Methods:
methodDict = {
    "0xf4d98717": "lockTokenPayment",
    "0x7d29985b": "refund",
    "0xee4128f6": "unlockCarPayment",
    "0x724e78da": "setPriceFeed",
    "0x7a9b0412": "setChainlinkOracle"
}

# lockTokenPayment = '0xf4d98717' # lockTokenPayment(tuple param)
# refund = '0x7d29985b' # refund(string[] bidTokens)
# unlockCarPayment = '0xee4128f6' # unlockCarPayment(string dealId,string network,address recipient)
# setPriceFeed(address priceFeed_)
# setChainlinkOracle(address oracle)

resDict = {
    "0": "failed",
    "1": "success"
}

res = requests.get( "https://api.polygonscan.com/api" 
    + "?module=account"
    + "&action=txlist"
    + "&address=" + contractAddress
    + "&startblock=" + startblock
    + "&endblock=" + endblock
    + "&sort=asc"
    + "&apikey=" + apikey )

resJSON = res.json()["result"]

for i in resJSON:
    #print(i)
    print(i["blockNumber"],resDict[i["txreceipt_status"]], i["timeStamp"], methodDict[i["methodId"]])

# 32818037
# 38482565
# 38519147

# lockpayment: {'blockNumber': '38542683', 'timeStamp': '1674723650', 'hash': '0xbb4e80a1f9272fd57c844b6c3c609658a1ba0124f7c9c3a3cd9920fa1c3111c5', 'nonce': '2', 'blockHash': '0x496e17a949d4f52b872c4addaa373e7643c7db7b09256b2e89abe00bda13de10', 'transactionIndex': '66', 'from': '0x564d74c420c66dd2e29e795ebe381f9462addb46', 'to': '0xa1f32c758c4324cc3070a3aa107c4dc7ddfe1a6f', 'value': '0', 'gas': '8000000', 'gasPrice': '62666870994', 'isError': '0', 'txreceipt_status': '1', 'input': '0xf4d98717000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000007e9000000000000000000000000007042d0a8f7ed7d6051fd7032515338f59ff872b2000000000000000000000000000000000000000000000000000000000000a0f50000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000005231303437653036642d656532382d346338312d386239652d373565363065336232626231516d644a5172376b4a3864596f6b6775344e4e7952466f59476133646d576a4b65794235656377564c58413251310000000000000000000000000000', 'contractAddress': '', 'cumulativeGasUsed': '12999772', 'gasUsed': '300957', 'confirmations': '57733', 'methodId': '0xf4d98717', 'functionName': 'lockTokenPayment(tuple param)'}
# refund: {'blockNumber': '38005920', 'timeStamp': '1673571158', 'hash': '0x304ebdf4b21730f8d51560478023d3780d328fbb49c63ff2627c2ad2bd5e68b4', 'nonce': '6039', 'blockHash': '0x316c2667ea912f7a79318b1c64a55ee8f869ec6b79b7e333f25a2539b87e95cf', 'transactionIndex': '44', 'from': '0xd44cde0f3beef47af166fc763b52977a43bf8fe7', 'to': '0xa1f32c758c4324cc3070a3aa107c4dc7ddfe1a6f', 'value': '0', 'gas': '8000000', 'gasPrice': '35890376020', 'isError': '0', 'txreceipt_status': '1', 'input': '0x7d29985b00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000005264313765666630622d316138652d343566612d626331322d666464613131353066313864516d5241786462624d50665462367a5874617552546b6d504b734c3267454d4d475841474244695967626769324e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005264303433306638312d663934392d343064342d616565392d353239633765626230373061516d5241786462624d50665462367a5874617552546b6d504b734c3267454d4d475841474244695967626769324e0000000000000000000000000000', 'contractAddress': '', 'cumulativeGasUsed': '7791151', 'gasUsed': '44998', 'confirmations': '594496', 'methodId': '0x7d29985b', 'functionName': 'refund(string[] bidTokens)'}